---
layout: post
title: Interpreter Pattern
date: 2015-11-29 00:00:00
---

## まえがき

『Rubyによるデザインパターン』を読んでいます。

インタプリタパターンを確認してみたいと思います。

インタプリタパターンには通常２つのステップがあるようです。１つは、テキストをパースするステップ。もう１つは、そのパースしたデータ構造を評価するステップです。

- テキストをパースするステップ
- パースしたデータ構造を評価するステップ

パースとは、テキストをプログラムで扱えるデータ構造に変換することです。または、抽象構文木(Abstract Syntax Tree)を自動で組み立てることです。

直接データ構造を用意すれば、パースするステップを省略できます。今回はパースするステップを省略します。

したがって、データ構造を評価するステップのみを取り扱います。

パースするステップは省略できますが、ASTは必要です。

ASTはコンポジットパターンで表現されます。(コンポジットパターン以外で表現されることもあるかもしれません)

ファイルを検索するプログラムを通して、ASTの要素を用意して、ASTを手動で組み立て、ASTを評価してみたいと思います。

## インタプリタパターン

ファイルを検索するプログラムをインタプリタパターンを使って実装してみます。

[こちら](https://github.com/t-mochizuki/interpreter-for-file-search)にリポジトリを用意しました。

こんな感じで使います。

``` sh
scala> import Interpreter._
import Interpreter._

scala> And(All(), Not(Readable()))
res0: Interpreter.And = And(All(),Not(Readable()))

scala> res0.evaluate("./tmp")
res1: Seq[java.io.File] = List(./tmp/kyoto/d.txt)
```

このように手動でASTを用意すれば、パーサは不要になります。

## あとがき

インタプリタパターンを確認しました。
